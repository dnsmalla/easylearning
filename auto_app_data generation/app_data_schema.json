{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "version": "1.0.0",
  "app_version": "1.0.0",
  "last_updated": "2025-11-20",
  "description": "Data structure specification for JLearn app. Update this file when app data requirements change.",
  
  "definitions": {
    "flashcard": {
      "type": "object",
      "required": ["id", "front", "back", "reading", "meaning", "level", "category"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_]+$",
          "description": "Unique identifier for the flashcard"
        },
        "front": {
          "type": "string",
          "minLength": 1,
          "description": "Japanese word or kanji (what user sees first)"
        },
        "back": {
          "type": "string",
          "minLength": 1,
          "description": "Reading in kana"
        },
        "reading": {
          "type": "string",
          "minLength": 1,
          "description": "Furigana/kana reading (should match back)"
        },
        "meaning": {
          "type": "string",
          "minLength": 1,
          "description": "English meaning(s), semicolon-separated if multiple"
        },
        "example": {
          "type": "string",
          "description": "Example sentence in Japanese (optional)"
        },
        "exampleReading": {
          "type": "string",
          "description": "Reading for example sentence (optional)"
        },
        "exampleMeaning": {
          "type": "string",
          "description": "English translation of example (optional)"
        },
        "level": {
          "type": "string",
          "enum": ["N5", "N4", "N3", "N2", "N1"],
          "description": "JLPT level"
        },
        "category": {
          "type": "string",
          "enum": ["vocabulary", "kanji", "grammar"],
          "description": "Type of flashcard"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Optional tags for categorization"
        },
        "audioURL": {
          "type": "string",
          "format": "uri",
          "description": "Optional URL to audio pronunciation"
        },
        "isFavorite": {
          "type": "boolean",
          "default": false,
          "description": "User favorite status"
        },
        "lastReviewed": {
          "type": "string",
          "format": "date-time",
          "description": "Last review timestamp"
        },
        "nextReview": {
          "type": "string",
          "format": "date-time",
          "description": "Next scheduled review"
        },
        "reviewCount": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "description": "Number of times reviewed"
        },
        "correctCount": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "description": "Number of correct answers"
        }
      }
    },
    
    "grammar": {
      "type": "object",
      "required": ["id", "title", "pattern", "meaning", "level"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_]+$",
          "description": "Unique identifier"
        },
        "title": {
          "type": "string",
          "minLength": 1,
          "description": "Grammar point title"
        },
        "pattern": {
          "type": "string",
          "minLength": 1,
          "description": "Grammar pattern in Japanese"
        },
        "meaning": {
          "type": "string",
          "minLength": 1,
          "description": "English explanation"
        },
        "level": {
          "type": "string",
          "enum": ["N5", "N4", "N3", "N2", "N1"],
          "description": "JLPT level"
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "japanese": { "type": "string" },
              "reading": { "type": "string" },
              "english": { "type": "string" }
            }
          },
          "description": "Example sentences"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or usage tips"
        }
      }
    },
    
    "practice": {
      "type": "object",
      "required": ["id", "type", "question", "answer", "level"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_]+$",
          "description": "Unique identifier"
        },
        "type": {
          "type": "string",
          "enum": ["multiple_choice", "fill_blank", "listening", "reading", "writing"],
          "description": "Type of practice exercise"
        },
        "question": {
          "type": "string",
          "minLength": 1,
          "description": "The question or prompt"
        },
        "answer": {
          "type": "string",
          "minLength": 1,
          "description": "Correct answer"
        },
        "options": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Options for multiple choice (if applicable)"
        },
        "level": {
          "type": "string",
          "enum": ["N5", "N4", "N3", "N2", "N1"],
          "description": "JLPT level"
        },
        "explanation": {
          "type": "string",
          "description": "Explanation of the answer"
        }
      }
    }
  },
  
  "type": "object",
  "required": ["flashcards", "grammar", "practice"],
  "properties": {
    "flashcards": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/flashcard"
      },
      "description": "Array of flashcard objects"
    },
    "grammar": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/grammar"
      },
      "description": "Array of grammar point objects"
    },
    "practice": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/practice"
      },
      "description": "Array of practice exercise objects"
    }
  },
  
  "metadata": {
    "jlpt_levels": {
      "N5": {
        "name": "Beginner",
        "description": "Basic greetings and simple phrases",
        "min_flashcards": 50,
        "max_flashcards": 1000,
        "target_vocab": 800,
        "target_kanji": 100,
        "target_grammar": 80
      },
      "N4": {
        "name": "Elementary",
        "description": "Common everyday conversations",
        "min_flashcards": 50,
        "max_flashcards": 1500,
        "target_vocab": 1500,
        "target_kanji": 300,
        "target_grammar": 200
      },
      "N3": {
        "name": "Intermediate",
        "description": "Detailed conversations on various topics",
        "min_flashcards": 50,
        "max_flashcards": 2000,
        "target_vocab": 3700,
        "target_kanji": 650,
        "target_grammar": 400
      },
      "N2": {
        "name": "Advanced",
        "description": "Complex discussions and formal language",
        "min_flashcards": 50,
        "max_flashcards": 3000,
        "target_vocab": 6000,
        "target_kanji": 1000,
        "target_grammar": 600
      },
      "N1": {
        "name": "Proficient",
        "description": "Native-level fluency and cultural nuances",
        "min_flashcards": 50,
        "max_flashcards": 5000,
        "target_vocab": 10000,
        "target_kanji": 2000,
        "target_grammar": 800
      }
    },
    
    "categories": {
      "vocabulary": {
        "name": "Vocabulary",
        "color": "blue",
        "icon": "book.closed.fill"
      },
      "kanji": {
        "name": "Kanji",
        "color": "red",
        "icon": "character.textbox"
      },
      "grammar": {
        "name": "Grammar",
        "color": "green",
        "icon": "text.book.closed.fill"
      }
    },
    
    "validation_rules": {
      "flashcard_id_format": "^(web|auto|manual)_[a-z0-9]+_[a-z]+_[0-9]{3,}$",
      "allow_empty_arrays": true,
      "require_examples": false,
      "strict_mode": false
    },
    
    "app_features": {
      "spaced_repetition": true,
      "audio_support": true,
      "furigana_display": true,
      "translation": true,
      "games": true,
      "web_search": true,
      "camera_translation": true
    }
  },
  
  "changelog": [
    {
      "version": "1.0.0",
      "date": "2025-11-20",
      "changes": [
        "Initial schema creation",
        "Added flashcard, grammar, and practice definitions",
        "Added JLPT level metadata",
        "Added validation rules"
      ]
    }
  ],
  
  "notes": [
    "When adding new required fields, increment major version (e.g., 1.0.0 -> 2.0.0)",
    "When adding optional fields, increment minor version (e.g., 1.0.0 -> 1.1.0)",
    "When fixing bugs or clarifications, increment patch version (e.g., 1.0.0 -> 1.0.1)",
    "Update the changelog when making changes",
    "Run validation tests after schema updates",
    "Regenerate data after breaking changes"
  ]
}

